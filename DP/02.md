# 情報基礎実験 動的計画法2
05-175511 中林亮

## 1. forwardアルゴリズムの変更
ギャップがx,yに跨って連続していた場合に、二重に数えてしまう問題が生じる。
第1回の実験のように、$f^y_{i,j}$の2項目を消す、つまり、
$$f^y_{i,j} = f^M_{i,j-1} \exp (-d/T) + f^y_{i,j-1} \exp (-e/T)$$
とすると、yのギャップからxのギャップへの遷移は許すが、xのギャップからyのギャップを禁止することになる。だから、この新しいアルゴリズムは、ギャップの連続が生じる時に、yのギャップを左側に詰めた後にxのギャップを配置した形になっているアラインメントのみを数える。目的の順序違いをカウントしないアルゴリズムになっている。


## 2,3. forwardアルゴリズム・アラインメント確率計算の実装
`prob.py`に実装した。`python prob.py`で課題2と3の計算が行われる。
実行結果は次の通り。まずシークエンスに対する分配関数と実験1のアルゴリズムでアラインメントしたスコアが-1のアライメントが正しい確率は、
```
Z: 12.948757442215085 420314.0471742903
probability: log= -13.948757442215085 p= 8.752489802438008e-07
```
となった。

またアラインメント確率は
```
(i,j)=(0,3) 0.0
(i,j)=(10,17) 2.274954167333883e-21
```
となった。

## 4. HMMの隠れ状態推定 Viterbiアルゴリズムの実装
`HMM.py`に実装した。`python HMM.py`を実行することで、`./param.txt`のパラメータと、`./sample.fasta`を読み込んで計算が行われる。

実行結果は

```
result02222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222333333
33333333333333333311111133333333344444444444444
44433331111111111111111111111111111111113333333
33333111111122222222222222222222222222222222222
22222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222
222222222
```

となった。
